(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{3354:(e,t,s)=>{Promise.resolve().then(s.bind(s,5967))},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},5967:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),a=s(8279),l=s(5695),o=s(2115);function n(e){let{pollId:t}=e,[s,n]=(0,o.useState)(null),[c,i]=(0,o.useState)([]),[d,u]=(0,o.useState)(""),[m,h]=(0,o.useState)(!0),[x,p]=(0,o.useState)(!1),g=(0,l.useRouter)(),b=e=>{u(e),setTimeout(()=>{u("")},3e3)};(0,o.useEffect)(()=>{(async()=>{try{let e=await (0,a.gU)(t);if(e.alreadySubmitted)return void g.push("/poll/results/".concat(t));n(e.poll),i(e.poll.options.map(e=>({...e,isChecked:!1}))),h(!1)}catch(e){b("Failed to load poll."),h(!1)}})()},[t,g]);let f=async()=>{if(0===j.length)return void b("Please select at least one option.");p(!0);try{await (0,a.Oi)({pollId:t,pollOptionIds:j.map(e=>e.id)}),g.push("/poll/results/".concat(t))}catch(e){console.error(e),b("Failed to submit poll. Please try again."),p(!1)}},y=e=>{s&&i(t=>{let r=t.filter(e=>e.isChecked).length;return!t[e].isChecked&&r>=Number(s.maxResponseOptions)?t:t.map((t,s)=>s===e?{...t,isChecked:!t.isChecked}:t)})},j=c.filter(e=>e.isChecked);return m?(0,r.jsx)("div",{className:"min-h-screen py-8",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundAttachment:"fixed"},children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border p-8",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading poll..."})]})})})}):s?(0,r.jsx)("div",{className:"min-h-screen py-8",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundAttachment:"fixed"},children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsxs)("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.question}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Select up to ",s.maxResponseOptions," option",1!==Number(s.maxResponseOptions)?"s":""]})]}),(0,r.jsx)("div",{className:"space-y-4 mb-8",children:c.map((e,t)=>{let a=!e.isChecked&&j.length>=Number(s.maxResponseOptions);return(0,r.jsx)("div",{className:"relative p-4 rounded-lg border-2 cursor-pointer transition-all ".concat(e.isChecked?"border-blue-500 bg-blue-50":a?"border-gray-200 bg-gray-100 cursor-not-allowed opacity-60":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50"),onClick:()=>!a&&y(t),children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:e.isChecked,disabled:a,onChange:()=>y(t),className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),(0,r.jsx)("label",{className:"text-gray-900 font-medium cursor-pointer flex-1",children:e.name})]})},e.id||t)})}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("button",{className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors font-medium text-lg disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",onClick:f,disabled:0===j.length||x,children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Submit Vote".concat(j.length>1?"s":"")}),0===j.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Please select at least one option to submit your vote"}),j.length>0&&(0,r.jsxs)("p",{className:"text-sm text-green-600 text-center mt-2",children:[j.length," option",1!==j.length?"s":""," selected"]})]}),(0,r.jsx)("div",{className:"mt-8 pt-6 border-t text-center",children:(0,r.jsx)("button",{onClick:()=>g.push("/poll/results/".concat(s.id)),className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors font-medium",children:"View Current Results"})}),d&&(0,r.jsx)("div",{className:"mt-6 p-4 rounded-lg bg-red-50 border border-red-200",children:(0,r.jsx)("p",{className:"text-center font-medium text-red-800",children:d})})]})})}):(0,r.jsx)("div",{className:"min-h-screen py-8",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundAttachment:"fixed"},children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border p-8",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"❌"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Poll not found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"The poll you're looking for doesn't exist or has been removed."}),(0,r.jsx)("button",{onClick:()=>window.location.href="/poll",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-medium",children:"View All Polls"})]})})})})}function c(){let e=Number((0,l.useParams)().pollId);return(0,r.jsx)(n,{pollId:e})}},8279:(e,t,s)=>{"use strict";s.d(t,{Gi:()=>l,gU:()=>o,AF:()=>n,Ps:()=>c,Oi:()=>i});var r=s(8350);let a="http://34.18.142.59:8080";async function l(e){let t=await fetch("".concat(a,"/createPoll"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,createdBy:r.x.getUserId()})});if(!t.ok)throw Error("Failed to create poll");return await t.json()}async function o(e){let t=await fetch("".concat(a,"/getPoll/").concat(e,"/").concat(r.x.getUserId()),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to create poll");return await t.json()}async function n(e){let t=await fetch("".concat(a,"/getPollResults/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});return await t.json()}async function c(){let e=await fetch("".concat(a,"/getPolls/").concat(r.x.getUserId()),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to create poll");return await e.json()}async function i(e){let t=await fetch("".concat(a,"/submitPoll/").concat(r.x.getUserId()),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to submit poll");return await t.json()}},8350:(e,t,s)=>{"use strict";s.d(t,{x:()=>r});let r={getUserId(){let e=localStorage.getItem("poll_user_id");return e||(e=crypto.randomUUID(),localStorage.setItem("poll_user_id",e)),e},hasCreatedPolls:()=>"true"===localStorage.getItem("hasCreatedPolls"),setHasCreatedPolls(){localStorage.setItem("hasCreatedPolls","true")},clearHasCreatedPolls(){localStorage.removeItem("hasCreatedPolls")}}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(3354)),_N_E=e.O()}]);